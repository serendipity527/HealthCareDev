# ğŸš€ AI èŠå¤©åº”ç”¨å¯åŠ¨æŒ‡å—

## ä¸€ã€å¿«é€Ÿå¯åŠ¨

### æ–¹æ³•1ï¼šä½¿ç”¨ IDEA å¯åŠ¨ï¼ˆæ¨èï¼‰

1. åœ¨ IDEA ä¸­æ‰“å¼€é¡¹ç›®
2. æ‰¾åˆ°ä¸»ç±» `HealthCareDevApplication.java`
3. ç‚¹å‡»ç±»æ—è¾¹çš„ç»¿è‰²è¿è¡ŒæŒ‰é’® â–¶ï¸
4. ç­‰å¾…å¯åŠ¨å®Œæˆï¼ˆçœ‹åˆ° "Started HealthCareDevApplication" æ—¥å¿—ï¼‰
5. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8080/chat.html

### æ–¹æ³•2ï¼šä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬å¯åŠ¨

åŒå‡»è¿è¡Œï¼š`start-chat.bat`

### æ–¹æ³•3ï¼šä½¿ç”¨ Maven å‘½ä»¤å¯åŠ¨

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
mvn spring-boot:run
```

## äºŒã€éªŒè¯å¯åŠ¨æˆåŠŸ

### 1. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

å¯åŠ¨æˆåŠŸåï¼Œåº”è¯¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹æ—¥å¿—ï¼š

```
Started HealthCareDevApplication in X.XXX seconds
Tomcat started on port(s): 8080 (http)
```

### 2. è®¿é—®èŠå¤©ç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8080/chat.html

çœ‹åˆ°ï¼š
- âœ… é¡µé¢æ ‡é¢˜ï¼š**ğŸ¤– AI æ™ºèƒ½èŠå¤©åŠ©æ‰‹**
- âœ… è¿æ¥çŠ¶æ€ï¼š**å·²è¿æ¥**ï¼ˆç»¿ç‚¹ï¼‰
- âœ… æ¬¢è¿æ¶ˆæ¯ï¼šå°åŒ»AIåŠ©æ‰‹çš„æ¬¢è¿è¯­

## ä¸‰ã€æµ‹è¯• AI å¯¹è¯

### æµ‹è¯•æ¶ˆæ¯ç¤ºä¾‹

1. **ç®€å•é—®å€™**
   ```
   ä½ å¥½
   ```
   AI åº”è¯¥å‹å¥½åœ°å›å¤

2. **é—®é—®é¢˜**
   ```
   ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ
   ```
   AI ä¼šç»™å‡ºè¯¦ç»†è§£é‡Š

3. **å¤šè½®å¯¹è¯**
   ```
   ç”¨æˆ·ï¼šä»‹ç»ä¸€ä¸‹ Spring Boot
   AIï¼š[å›å¤]
   ç”¨æˆ·ï¼šå®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ
   AIï¼š[å›å¤ï¼ŒåŸºäºä¸Šä¸‹æ–‡]
   ```

## å››ã€å½“å‰é…ç½®ä¿¡æ¯

### AI æœåŠ¡é…ç½®

```yaml
æœåŠ¡å•†ï¼šé˜¿é‡Œäº‘é€šä¹‰åƒé—®
API å¯†é’¥ï¼šsk-43070f4cd1074965a93a03d6d5333cd8
æ¨¡å‹ï¼šqwen3-max
æ¸©åº¦ï¼š0.7
è¶…æ—¶ï¼š60ç§’
```

### åº”ç”¨é…ç½®

```yaml
ç«¯å£ï¼š8080
WebSocket ç«¯ç‚¹ï¼š/websocket
åº”ç”¨æ¶ˆæ¯å‰ç¼€ï¼š/app
æ¶ˆæ¯ä»£ç†å‰ç¼€ï¼š/topic
```

## äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šå¯åŠ¨å¤±è´¥ - ç«¯å£è¢«å ç”¨

**é”™è¯¯æç¤º**ï¼š
```
Port 8080 was already in use
```

**è§£å†³æ–¹æ³•**ï¼š
```bash
# æ–¹æ³•1ï¼šä¿®æ”¹ç«¯å£
# ç¼–è¾‘ application.ymlï¼Œå°† port: 8080 æ”¹ä¸ºå…¶ä»–ç«¯å£å¦‚ 8081

# æ–¹æ³•2ï¼šå…³é—­å ç”¨ç«¯å£çš„ç¨‹åº
netstat -ano | findstr :8080
taskkill /F /PID <è¿›ç¨‹ID>
```

### é—®é¢˜2ï¼šAI å›å¤"æœåŠ¡æš‚æ—¶ä¸å¯ç”¨"

**å¯èƒ½åŸå› **ï¼š
1. API å¯†é’¥æ— æ•ˆæˆ–è¿‡æœŸ
2. ç½‘ç»œè¿æ¥é—®é¢˜
3. é˜¿é‡Œäº‘è´¦æˆ·ä½™é¢ä¸è¶³
4. API è°ƒç”¨è¶…æ—¶

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ API å¯†é’¥æ˜¯å¦æ­£ç¡®
2. æŸ¥çœ‹æ§åˆ¶å°çš„è¯¦ç»†é”™è¯¯æ—¥å¿—
3. ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°æ£€æŸ¥è´¦æˆ·çŠ¶æ€
4. å°è¯•å¢åŠ è¶…æ—¶æ—¶é—´

### é—®é¢˜3ï¼šWebSocket è¿æ¥å¤±è´¥

**ç—‡çŠ¶**ï¼šé¡µé¢æ˜¾ç¤º"è¿æ¥å·²æ–­å¼€"

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®è®¤åç«¯æœåŠ¡å·²å¯åŠ¨
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯ï¼ˆF12ï¼‰
3. ç¡®è®¤è®¿é—®åœ°å€æ­£ç¡®ï¼ˆhttp://localhost:8080/chat.htmlï¼‰
4. å°è¯•æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡æ–°è®¿é—®

### é—®é¢˜4ï¼šMaven å‘½ä»¤ä¸å¯ç”¨

**é”™è¯¯æç¤º**ï¼š
```
mvn ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤
```

**è§£å†³æ–¹æ³•**ï¼š
ä½¿ç”¨ IDEA çš„å†…ç½® Maven æˆ–å®‰è£… Maven å¹¶é…ç½®ç¯å¢ƒå˜é‡

## å…­ã€å¼€å‘è°ƒè¯•

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

æ—¥å¿—çº§åˆ«å·²è®¾ç½®ä¸º DEBUGï¼Œå¯ä»¥çœ‹åˆ°ï¼š
- ç”¨æˆ·å‘é€çš„æ¶ˆæ¯
- AI ç”Ÿæˆçš„å›å¤
- LangChain4j çš„è¯·æ±‚å’Œå“åº”è¯¦æƒ…

### æ—¥å¿—ç¤ºä¾‹

```
æ”¶åˆ°ç”¨æˆ·æ¶ˆæ¯: ä½ å¥½
AI å›å¤: ä½ å¥½ï¼å¾ˆé«˜å…´è§åˆ°ä½ ...
Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions
Response: {"choices":[{"message":{"content":"..."}}]}
```

### ä¿®æ”¹ AI è¡Œä¸º

ç¼–è¾‘ `AiChatService.java` ä¸­çš„ `@SystemMessage`ï¼š

```java
@SystemMessage("""
    ä½ æ˜¯ä¸€ä¸ª{è‡ªå®šä¹‰è§’è‰²}ï¼Œåå­—å«{è‡ªå®šä¹‰åå­—}ã€‚
    {è‡ªå®šä¹‰è¡Œä¸ºè§„åˆ™}
    """)
```

## ä¸ƒã€æ‰©å±•åŠŸèƒ½å»ºè®®

### 1. æ·»åŠ èŠå¤©å†å²è®°å¿†

```java
@AiService
public interface AiChatService {
    String chat(@MemoryId String sessionId, @UserMessage String message);
}
```

### 2. æ·»åŠ æµå¼è¾“å‡º

```java
TokenStream chatStream(String message);
```

### 3. æ·»åŠ ç”¨æˆ·è®¤è¯

```java
@MessageMapping("/chat")
@SendToUser("/queue/messages")
public MessageDTO handleMessage(MessageDTO message, Principal principal) {
    // è·å–ç”¨æˆ·ä¿¡æ¯
    String username = principal.getName();
    // ...
}
```

### 4. æ·»åŠ æ•°æ®æŒä¹…åŒ–

ä¿å­˜èŠå¤©è®°å½•åˆ°æ•°æ®åº“ï¼ˆMySQLï¼‰

## å…«ã€ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. é…ç½®ç¯å¢ƒå˜é‡

```bash
export AI_API_KEY=your-production-api-key
export AI_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
export AI_MODEL_NAME=qwen-plus
```

### 2. æ‰“åŒ…åº”ç”¨

```bash
mvn clean package
```

### 3. è¿è¡Œ JAR åŒ…

```bash
java -jar target/healthCareDev-0.0.1-SNAPSHOT.jar
```

### 4. ä½¿ç”¨ Docker éƒ¨ç½²

```dockerfile
FROM openjdk:17-jdk-slim
COPY target/healthCareDev-0.0.1-SNAPSHOT.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java","-jar","/app.jar"]
```

## ä¹ã€æŠ€æœ¯æ”¯æŒ

### ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®æ–‡æ¡£](DOC/)
- [AI é…ç½®æŒ‡å—](DOC/AI%20å¯¹è¯åŠŸèƒ½é…ç½®æŒ‡å—.md)
- [WebSocket èŠå¤©å®¤æŒ‡å—](DOC/WebSocket%20èŠå¤©å®¤ä½¿ç”¨æŒ‡å—.md)
- [æ•…éšœæ’æŸ¥](DOC/troubleshooting.md)

### è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£æˆ–æäº¤ Issueã€‚

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰**




